/*! luna loader v1 - MIT License */
((e,t)=>{const n={},r=new Set,a=async t=>{const a=t.getAttribute("ln:id");if(!a||r.has(a))return;r.add(a);const s=t.getAttribute("ln:url");if(!s)return;const o=await(async t=>{const n=t.getAttribute("ln:state");if(!n)return null;if(n.startsWith("#")){const t=e.getElementById(n.slice(1));return t?JSON.parse(t.textContent):null}if(n.startsWith("url:"))return(await fetch(n.slice(4))).json();try{return JSON.parse(n)}catch{return null}})(t);n[a]=o;try{const e=await import(s),n=t.getAttribute("ln:export"),r=n?e[n]:e.hydrate||e.default;r&&r(t,o,a)}catch(e){console.error(`[ln-loader] Failed to hydrate ${a}:`,e)}},s=n=>{const r=n.getAttribute("ln:trigger")||"load";if("load"===r)"loading"===e.readyState?e.addEventListener("DOMContentLoaded",()=>a(n),{once:!0}):a(n);else if("idle"===r)"requestIdleCallback"in t?requestIdleCallback(()=>a(n)):setTimeout(()=>a(n),200);else if("visible"===r){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(e.disconnect(),a(n))})},{rootMargin:"50px"});e.observe(n)}else if(r.startsWith("media:")){const e=r.slice(6),s=t.matchMedia(e),o=()=>{s.matches&&(s.removeEventListener("change",o),a(n))};s.matches?a(n):s.addEventListener("change",o)}},o=()=>{e.querySelectorAll("[ln\\:id]").forEach(s)};e.querySelectorAll("script[data-resumable-state]").forEach(e=>{const t=e.getAttribute("data-resumable-state")||"_";n[t]=JSON.parse(e.textContent)}),e.querySelectorAll('script[type="ln/json"]').forEach(e=>{const t=e.id;t&&(n[t]=JSON.parse(e.textContent))}),"loading"===e.readyState?e.addEventListener("DOMContentLoaded",o,{once:!0}):o();new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{1===e.nodeType&&e.hasAttribute("ln:id")&&s(e)})})}).observe(e.body||e.documentElement,{childList:!0,subtree:!0}),t.__LN_STATE__=n,t.__LN_HYDRATE__=a,t.__LN_SCAN__=o})(document,window);